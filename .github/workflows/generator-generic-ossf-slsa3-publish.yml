name: Auto Feature Branch

on:
  issues:
    types: [opened]

jobs:
  create-feature-branch:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
      
      - name: Create branch
        id: create-branch
        run: |
          ISSUE_TITLE=$(echo ${{ github.event.issue.title }} | tr ' ' '-')
          git checkout -b feature/$ISSUE_TITLE
          git push origin feature/$ISSUE_TITLE

      - name: Update issue with branch name
        run: |
          ISSUE_NUMBER=$(echo ${{ github.event.issue.number }})
          BRANCH_NAME=$(echo ${{ steps.create-branch.outputs.branch }})
          echo "::set-output name=branch_name::$BRANCH_NAME"
          echo "Branch created: $BRANCH_NAME"
          echo "##[set-output name=branch_name;]$BRANCH_NAME"
